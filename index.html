<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Twibbon Generator</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    @keyframes gradient-shift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(79, 70, 229, 0.5); }
      50% { box-shadow: 0 0 40px rgba(79, 70, 229, 0.8); }
    }
    
    .gradient-bg {
      background: linear-gradient(-45deg, #667eea, #764ba2, #f093fb, #4facfe);
      background-size: 400% 400%;
      animation: gradient-shift 15s ease infinite;
    }
    
    .glass-effect {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .glow-effect {
      animation: pulse-glow 2s ease-in-out infinite;
    }
    
    #preview-container {
      position: relative;
      width: 100%;
      max-width: 500px;
      aspect-ratio: 1;
      margin: 0 auto;
      border-radius: 24px;
      overflow: hidden;
      transform: perspective(1000px) rotateY(0deg);
      transition: transform 0.6s ease;
    }
    
    #preview-container:hover {
      transform: perspective(1000px) rotateY(5deg) scale(1.02);
    }
    
    #user-photo {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    #twibbon-frame {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      pointer-events: none;
      z-index: 10;
    }
    
    .btn-hover {
      position: relative;
      overflow: hidden;
      transform: translateY(0);
      transition: all 0.3s ease;
    }
    
    .btn-hover:hover {
      transform: translateY(-3px);
    }
    
    .btn-hover::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .btn-hover:hover::before {
      width: 300px;
      height: 300px;
    }
    
    .floating-icon {
      animation: float 3s ease-in-out infinite;
    }
    
    .hidden {
      display: none;
    }
    
    .decorative-circle {
      position: absolute;
      border-radius: 50%;
      opacity: 0.1;
      pointer-events: none;
    }
    
    .circle-1 {
      width: 300px;
      height: 300px;
      top: -100px;
      right: -100px;
      background: linear-gradient(135deg, #667eea, #764ba2);
    }
    
    .circle-2 {
      width: 200px;
      height: 200px;
      bottom: 50px;
      left: -50px;
      background: linear-gradient(135deg, #f093fb, #4facfe);
    }
    
    .tip-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }
    
    .tip-card:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(10px);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div class="w-full h-full overflow-auto gradient-bg">
   <div class="min-h-full w-full relative" id="main-wrapper"><!-- Decorative Elements -->
    <div class="decorative-circle circle-1"></div>
    <div class="decorative-circle circle-2"></div>
    <div class="max-w-6xl mx-auto px-6 py-16 relative z-10"><!-- Header with Glass Effect -->
     <div class="text-center mb-12 glass-effect rounded-3xl p-10 mx-auto max-w-4xl">
      <div class="floating-icon mb-4">
       <svg class="w-20 h-20 mx-auto text-white" fill="currentColor" viewbox="0 0 20 20"><path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z" />
       </svg>
      </div>
      <h1 id="main-title" class="text-6xl font-black mb-4 text-white drop-shadow-lg">Selamat Datang Mahasiswa Baru</h1>
      <p id="subtitle" class="text-3xl text-white font-semibold opacity-90">Universitas Indonesia 2024</p>
     </div><!-- Instruction with Glow -->
     <p id="instruction" class="text-center text-xl mb-10 text-white font-medium drop-shadow-md">Upload foto Anda dan download twibbon untuk dibagikan di media sosial!</p><!-- Preview Container with Glow Effect -->
     <div class="mb-10 glow-effect">
      <div id="preview-container" class="border-4"><img id="user-photo" class="hidden" alt="Foto Anda"> <img id="twibbon-frame" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500'%3E%3Cdefs%3E%3ClinearGradient id='grad1' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23667eea;stop-opacity:0.95' /%3E%3Cstop offset='100%25' style='stop-color:%23764ba2;stop-opacity:0.95' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='500' height='500' fill='none'/%3E%3Cpath d='M 0 0 L 500 0 L 500 100 L 400 100 L 400 400 L 100 400 L 100 100 L 0 100 Z' fill='url(%23grad1)'/%3E%3Ctext x='250' y='55' font-family='Arial, sans-serif' font-size='32' font-weight='bold' fill='white' text-anchor='middle'%3Eâœ¨ MABA 2024 âœ¨%3C/text%3E%3Crect x='100' y='410' width='300' height='60' rx='30' fill='%23667eea' opacity='0.9'/%3E%3Ctext x='250' y='448' font-family='Arial, sans-serif' font-size='22' font-weight='bold' fill='white' text-anchor='middle'%3E%23MahasiswaBaru%3C/text%3E%3C/svg%3E" alt="Frame Twibbon">
       <div id="placeholder" class="absolute inset-0 flex items-center justify-center text-center p-8 glass-effect">
        <div>
         <svg class="w-32 h-32 mx-auto mb-6 text-white opacity-80" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
         </svg>
         <p class="text-2xl font-bold text-white">Upload Foto Anda</p>
         <p class="text-base text-white opacity-80 mt-2">Klik tombol di bawah untuk memilih foto</p>
        </div>
       </div>
      </div>
     </div><!-- Controls with Animations -->
     <div class="flex flex-col sm:flex-row gap-6 justify-center items-center mb-14"><input type="file" id="photo-input" accept="image/*" class="hidden"> <button id="upload-btn" class="btn-hover px-10 py-5 rounded-2xl font-bold text-xl shadow-2xl text-white relative z-10"> <span class="relative z-10">ðŸ“¸ <span id="upload-btn-text">Pilih Foto</span></span> </button> <button id="download-btn" class="hidden btn-hover px-10 py-5 rounded-2xl font-bold text-xl shadow-2xl text-white relative z-10"> <span class="relative z-10">ðŸ’¾ <span id="download-btn-text">Download Twibbon</span></span> </button>
     </div><!-- Tips Section with Cards -->
     <div class="mt-16 max-w-3xl mx-auto">
      <div class="glass-effect rounded-3xl p-8">
       <h3 class="font-black text-3xl mb-6 text-white text-center">ðŸ’¡ Tips untuk Hasil Terbaik</h3>
       <div class="space-y-4">
        <div class="tip-card p-5 rounded-xl">
         <p class="text-white text-lg font-medium">ðŸ“· Gunakan foto dengan resolusi tinggi</p>
        </div>
        <div class="tip-card p-5 rounded-xl">
         <p class="text-white text-lg font-medium">ðŸŽ¯ Pastikan wajah Anda berada di tengah foto</p>
        </div>
        <div class="tip-card p-5 rounded-xl">
         <p class="text-white text-lg font-medium">ðŸ“± Foto portrait (vertikal) lebih baik daripada landscape</p>
        </div>
        <div class="tip-card p-5 rounded-xl">
         <p class="text-white text-lg font-medium">ðŸ’¡ Pastikan pencahayaan foto cukup baik</p>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      background_gradient_1: '#667eea',
      background_gradient_2: '#764ba2',
      text_color: '#ffffff',
      button_color: '#667eea',
      border_color: '#667eea',
      font_family: 'system-ui, -apple-system, sans-serif',
      font_size: 16,
      main_title: 'Selamat Datang Mahasiswa Baru',
      subtitle: 'Universitas Indonesia 2024',
      instruction_text: 'Upload foto Anda dan download twibbon untuk dibagikan di media sosial!',
      upload_button_text: 'Pilih Foto',
      download_button_text: 'Download Twibbon'
    };

    async function onConfigChange(config) {
      const baseFontStack = 'system-ui, -apple-system, sans-serif';
      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      
      const mainWrapper = document.getElementById('main-wrapper');
      mainWrapper.style.fontFamily = `${customFont}, ${baseFontStack}`;
      
      const mainTitle = document.getElementById('main-title');
      mainTitle.textContent = config.main_title || defaultConfig.main_title;
      mainTitle.style.fontSize = `${baseSize * 3.75}px`;
      mainTitle.style.color = config.text_color || defaultConfig.text_color;
      mainTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      
      const subtitle = document.getElementById('subtitle');
      subtitle.textContent = config.subtitle || defaultConfig.subtitle;
      subtitle.style.fontSize = `${baseSize * 1.875}px`;
      subtitle.style.color = config.text_color || defaultConfig.text_color;
      subtitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      
      const instruction = document.getElementById('instruction');
      instruction.textContent = config.instruction_text || defaultConfig.instruction_text;
      instruction.style.fontSize = `${baseSize * 1.25}px`;
      instruction.style.color = config.text_color || defaultConfig.text_color;
      instruction.style.fontFamily = `${customFont}, ${baseFontStack}`;
      
      const uploadBtn = document.getElementById('upload-btn');
      uploadBtn.style.backgroundColor = config.button_color || defaultConfig.button_color;
      
      const uploadBtnText = document.getElementById('upload-btn-text');
      uploadBtnText.textContent = config.upload_button_text || defaultConfig.upload_button_text;
      
      const downloadBtn = document.getElementById('download-btn');
      downloadBtn.style.backgroundColor = config.button_color || defaultConfig.button_color;
      
      const downloadBtnText = document.getElementById('download-btn-text');
      downloadBtnText.textContent = config.download_button_text || defaultConfig.download_button_text;
      
      const previewContainer = document.getElementById('preview-container');
      previewContainer.style.borderColor = config.border_color || defaultConfig.border_color;
      
      const tipCards = document.querySelectorAll('.tip-card p');
      tipCards.forEach(card => {
        card.style.fontSize = `${baseSize * 1.125}px`;
        card.style.color = config.text_color || defaultConfig.text_color;
        card.style.fontFamily = `${customFont}, ${baseFontStack}`;
      });
      
      const tipsHeading = document.querySelector('.mt-16 h3');
      tipsHeading.style.fontSize = `${baseSize * 1.875}px`;
      tipsHeading.style.color = config.text_color || defaultConfig.text_color;
      tipsHeading.style.fontFamily = `${customFont}, ${baseFontStack}`;
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_gradient_1 || defaultConfig.background_gradient_1,
              set: (value) => {
                window.elementSdk.config.background_gradient_1 = value;
                window.elementSdk.setConfig({ background_gradient_1: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                window.elementSdk.config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.button_color || defaultConfig.button_color,
              set: (value) => {
                window.elementSdk.config.button_color = value;
                window.elementSdk.setConfig({ button_color: value });
              }
            },
            {
              get: () => config.border_color || defaultConfig.border_color,
              set: (value) => {
                window.elementSdk.config.border_color = value;
                window.elementSdk.setConfig({ border_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              window.elementSdk.config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              window.elementSdk.config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ['main_title', config.main_title || defaultConfig.main_title],
          ['subtitle', config.subtitle || defaultConfig.subtitle],
          ['instruction_text', config.instruction_text || defaultConfig.instruction_text],
          ['upload_button_text', config.upload_button_text || defaultConfig.upload_button_text],
          ['download_button_text', config.download_button_text || defaultConfig.download_button_text]
        ])
      });
    }

    const photoInput = document.getElementById('photo-input');
    const uploadBtn = document.getElementById('upload-btn');
    const downloadBtn = document.getElementById('download-btn');
    const userPhoto = document.getElementById('user-photo');
    const placeholder = document.getElementById('placeholder');

    uploadBtn.addEventListener('click', () => {
      photoInput.click();
    });

    photoInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (event) => {
          userPhoto.src = event.target.result;
          userPhoto.classList.remove('hidden');
          placeholder.classList.add('hidden');
          downloadBtn.classList.remove('hidden');
        };
        reader.readAsDataURL(file);
      }
    });

    downloadBtn.addEventListener('click', async () => {
      const container = document.getElementById('preview-container');
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      
      const size = 1000;
      canvas.width = size;
      canvas.height = size;
      
      const photoImg = new Image();
      photoImg.src = userPhoto.src;
      
      await new Promise((resolve) => {
        photoImg.onload = resolve;
      });
      
      ctx.drawImage(photoImg, 0, 0, size, size);
      
      const frameImg = new Image();
      frameImg.src = document.getElementById('twibbon-frame').src;
      
      await new Promise((resolve) => {
        frameImg.onload = resolve;
      });
      
      ctx.drawImage(frameImg, 0, 0, size, size);
      
      canvas.toBlob((blob) => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'twibbon-mahasiswa-baru.png';
        a.click();
        URL.revokeObjectURL(url);
      }, 'image/png');
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9accb0bce4280884',t:'MTc2NTUzNjkzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
